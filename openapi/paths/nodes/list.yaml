get:
  operationId: listNodes
  tags: [nodes]
  summary: List all imported nodes in the node pool
  description: |
    **List nodes in the pool**
    
    Retrieve all nodes in your node pool, including both self-managed (SSH) nodes and cloud-imported nodes.
    Nodes can be filtered by type and provider to help you find specific nodes.
    
    **Filtering:**
    - `node_type`: Filter by node type - `CLOUD` for cloud-imported nodes or `SELF_MANAGED` for SSH-managed nodes
    - `provider`: Filter by cloud provider (e.g., "aws", "azure", "gcp") - only applies to cloud nodes

    **Examples**

    Here's an example of how to filter by node type:
      ```
      /nodes?node_type=SELF_MANAGED
      ```
      
      Here's an example of how to filter by provider:
      ```
      /nodes?provider=aws
      ```

  parameters:
    - name: node_type
      in: query
      description: |
        Only return nodes of this type.  
        Possible values:
        - `SELF_MANAGED` - only self-managed (SSH) nodes  
        - `CLOUD` - only cloud-imported nodes
      required: false
      schema:
        type: string
        enum: [CLOUD, SELF_MANAGED]
        x-enum-varnames: [CLOUD, SELF_MANAGED]
        description: >
          The type of the node.
          - `CLOUD`: Cloud node
          - `SELF_MANAGED`: Self-managed node
    - name: provider
      in: query
      description: |
        Only return nodes of this provider.
        Example:
        - `aws` - only AWS node instances
      required: false
      schema:
        type: string

  responses:
    '200':
      $ref: '../../components/responses/nodes-list-response.yaml'
      useExample: default
    '422':
      $ref: '../../components/responses/error-response.yaml'
      useExample: node-invalid-type
    '500':
      $ref: '../../components/responses/error-response.yaml'
      useExample: server-error
  x-codeSamples:
    - lang: curl
      label: cURL
      source: |
        curl -X GET "https://api.exalsius.ai/nodes?node_type=CLOUD&provider=aws"
    - lang: python
      label: Python
      source: |
        import requests
        from typing import Optional

        def get_nodes(
            node_type: Optional[str] = None,
            provider: Optional[str] = None
        ) -> dict:
            """
            Fetch nodes with optional filtering parameters.

            Args:
                node_type: The type of nodes to return
                provider: The provider of the nodes to return
                
            Returns:
                dict: The JSON response containing the nodes
            """
            url = "https://api.exalsius.ai/nodes"
            params = {}
            if node_type:
                params['node_type'] = node_type
            if provider:
                params['provider'] = provider
            response = requests.get(url, params=params)
            return response.json()
        
        nodes = get_nodes(node_type="CLOUD", provider="aws")
        print(nodes)
        
